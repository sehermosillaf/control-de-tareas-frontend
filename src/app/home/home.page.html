<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>¡Bienvenido, {{user.nombre}}! </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <app-modal-tarea></app-modal-tarea>
  <ng-container *ngFor="let tasks of tasksUser">
    <ion-card (click)="getTareaID(tasks.id)">
      <ion-card-header>
        <ion-card-title>{{tasks.nombre}}</ion-card-title>
        <ion-card-subtitle>Descripción: {{tasks.descripcion}}</ion-card-subtitle>
        <ion-card-subtitle>Fecha creación: {{tasks.fechaCreacion}}</ion-card-subtitle>
        <ion-card-subtitle>Fecha inicio:{{tasks.fechaInicio}}</ion-card-subtitle>
        <ion-card-subtitle>Fecha termino: {{tasks.fechaTermino}}</ion-card-subtitle>
        <ion-card-subtitle>Estado: {{tasks.estado.nombre}}</ion-card-subtitle>
      </ion-card-header>
      <ion-button id="open-modal" expand="fill" color="danger" class="ion-margin">
        Rechazar
      </ion-button>
      <ion-button expand="fill" (click)="setOpen(true); getSubtareas(tasks.subtareas)">Ver detalles</ion-button>
      <ion-modal [isOpen]="isModalOpen">
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-title>Tareas subordinadas</ion-title>
              <ion-buttons slot="end">
                <ion-button (click)="setOpen(false)">Volver</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>
          <ion-card *ngFor="let sub of subtask">
            <ion-card-header>
              <ion-card-title>{{sub.nombre}}</ion-card-title>
              <ion-card-subtitle></ion-card-subtitle>
              <ion-card-subtitle>Descripcion: {{sub.descripcion}}</ion-card-subtitle>
              <ion-card-subtitle>Fecha de inicio: {{sub.fechaInicio}}</ion-card-subtitle>
              <ion-card-subtitle>Fecha de termino: {{sub.fechaTermino}}</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ng-template>
      </ion-modal>
    </ion-card>
    <ion-modal>
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-buttons slot=" start">
              <ion-button (click)="cancel()">Cancelar</ion-button>
            </ion-buttons>
            <ion-title>Rechazar tarea</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="declineTask(tasks.id)" [strong]="true">Confirmar
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding">
          <ion-item>
            <ion-label position="stacked">Justificacion</ion-label>
            <ion-input type="text" placeholder="Escribe tu comentario..." [(ngModel)]="justificacion"></ion-input>
          </ion-item>
        </ion-content>
      </ng-template>
    </ion-modal>
  </ng-container>
</ion-content>